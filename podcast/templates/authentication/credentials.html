{% extends 'layout.html' %}

{% block content %}
<main id="main">
    <div class="formwrapper">
        <!-- Flash messages section -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="flash-messages">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        <h1 class="title">{{ title }}</h1>
        <form method="POST" action="{{ handler_url }}">
            {{ form.csrf_token }} <!-- WTForms requires this token -->

            <!-- Username field -->
            <div class="form-field">
                {{ form.user_name.label }}
                {{ form.user_name }}
                {% if form.user_name.errors or user_name_error_message is not none %}
                    <ul class="errors">
                        {% if user_name_error_message is not none %}
                            <li>{{ user_name_error_message }}</li>
                        {% endif %}
                        {% for error in form.user_name.errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>

            <!-- Password field -->
            <div class="form-field">
                {{ form.password.label }}
                {{ form.password }}
                {% if form.password.errors or password_error_message is not none %}
                    <ul class="errors">
                        {% if password_error_message is not none %}
                            <li>{{ password_error_message }}</li>
                        {% endif %}
                        {% for error in form.password.errors %}
                            <li>{{ error }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            </div>
            <!-- Register link between password and login button -->
            <p class="form-link">Don't have an account?
                <a href="{{ url_for('authentication_bp.register') }}">Register here</a>
            </p>

            <!-- Submit button -->
            {{ form.submit(class="btn", value=button_text) }}
            <!-- Register link -->

        </form>
    </div>
</main>
{% endblock %}
